version: '3'

# Benchmark Tasks
# Handles performance benchmarking

vars:
  PHP_82: data-helpers-php82
  PHP_83: data-helpers-php83
  PHP_84: data-helpers-php84
  DEFAULT_PHP: "{{.PHP_84}}"
  OUTPUT_HELPER: ./scripts/task-output.sh

tasks:
  run:
    desc: Run benchmarks (use PHP=8.2|8.3|8.4)
    aliases: [benchmark]
    cmds:
      - |
        source {{.OUTPUT_HELPER}}
        task_run "Running Benchmarks" \
          docker exec {{.PHP | default .DEFAULT_PHP}} vendor/bin/phpbench run --report=table

  dto:
    desc: Run Dto benchmarks (Traditional vs SimpleDto) [DEPRECATED - use bench:comprehensive]
    aliases: [bench:dto]
    cmds:
      - |
        source {{.OUTPUT_HELPER}}
        task_run "Running Dto Benchmarks" \
          docker exec {{.PHP | default .DEFAULT_PHP}} php scripts/dto-benchmark.php

  readme:
    desc: Run comprehensive benchmarks and update documentation (use PHP=8.2|8.3|8.4)
    aliases: [bench:all, bench:complete]
    cmds:
      - |
        source {{.OUTPUT_HELPER}}
        task_run "Running Comprehensive Benchmarks" \
          docker exec {{.PHP | default .DEFAULT_PHP}} php scripts/comprehensive-benchmark.php

